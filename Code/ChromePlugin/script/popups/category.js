function countrys() {
  var countrys = `Afghanistan,Aland Islands,Albania,Alderney,Algeria,American Samoa,Andorra,Angola,Anguilla,Antigua and Barbuda,Argentina,Armenia,Aruba,Ascension Island,Australia,Austria,Azerbaijan,Bahamas,Bahrain,Bangladesh,Barbados,Belarus,Belgium,Belize,Benin,Bermuda,Bhutan,Bolivia,Bosnia and Herzegovina,Botswana,Brazil,Bulgaria,Burkina Faso,Burundi,Cambodia,Cameroon,Canada,Cape Verde,Caribbean Netherlands,Cayman Islands,Central African Republic,Chad,Chile,Christmas Island,Cocos (Keeling) Islands,Colombia,Comoros,Congo, The Democratic Republic Of The,Congo, The Republic of Congo,Cook Islands,Costa Rica,Cote D'Ivoire,Croatia (local name: Hrvatska),Curacao,Cyprus,Czech Republic,Denmark,Djibouti,Dominica,Dominican Republic,Ecuador,Egypt,El Salvador,Equatorial Guinea,Eritrea,Estonia,Ethiopia,Falkland Islands (Malvinas),Faroe Islands,Fiji,Finland,France,French Guiana,French Polynesia,Gabon,Gambia,Georgia,Germany,Ghana,Gibraltar,Greece,Greenland,Grenada,Guadeloupe,Guam,Guatemala,Guernsey,Guinea,Guinea-Bissau,Guyana,Haiti,Honduras,Hong Kong,China,Hungary,Iceland,India,Indonesia,Iraq,Ireland,Israel,Italy,Jamaica,Japan,Jersey,Jordan,Kazakhstan,Kenya,Kiribati,Korea,Kosovo,Kuwait,Kyrgyzstan,Lao People's Democratic Republic,Latvia,Lebanon,Lesotho,Liberia,Libya,Liechtenstein,Lithuania,Luxembourg,Macau,China,Macedonia,Madagascar,Malawi,Malaysia,Maldives,Mali,Malta,Marshall Islands,Martinique,Mauritania,Mauritius,Mayotte,Mexico,Micronesia,Moldova,Monaco,Mongolia,Montenegro,Montserrat,Morocco,Mozambique,Myanmar,Namibia,Nauru,Negara Brunei Darussalam,Nepal,Netherlands,Netherlands Antilles,New Caledonia,New Zealand,Nicaragua,Niger,Nigeria,Niue,Norfolk Island,Northern Mariana Islands,Norway,Oman,Other Country,Pakistan,Palau,Palestine,Panama,Papua New Guinea,Paraguay,Peru,Philippines,Poland,Portugal,Puerto Rico,Qatar,Reunion,Romania,Russian Federation,Rwanda,Saint Barthelemy,Saint Kitts and Nevis,Saint Lucia,Saint Martin,Saint Vincent and the Grenadines,Samoa,San Marino,Sao Tome and Principe,Saudi Arabia,Senegal,Serbia,Seychelles,Sierra Leone,Singapore,Sint Maarten (Netherlands),Slovakia (Slovak Republic),Slovenia,Solomon Islands,Somalia,South Africa,South Georgia and the South Sandwich Islands,South Sudan,Spain,Sri Lanka,St. Pierre and Miquelon,Suriname,Swaziland,Sweden,Switzerland,Taiwan,China,Tajikistan,Tanzania,Thailand,Timor-Leste,Togo,Tonga,Trinidad and Tobago,Tunisia,Turkey,Turkmenistan,Turks and Caicos Islands,Tuvalu,Uganda,Ukraine,United Arab Emirates,United Kingdom,United States,Uruguay,Uzbekistan,Vanuatu,Vatican City State (Holy See),Venezuela,Vietnam,Virgin Islands (British),Virgin Islands (U.S.),Wallis And Futuna Islands,Yemen,Zambia,Zanzibar,Zimbabwe`
  return countrys.split(',')
}

function currencys() {
  var currencys = `USD   (  US Dollar  ),AFN   (  Afghan Afghani  ),EUR   (  Euro  ),ALL   (  Albanian Lek  ),AOA   (  Angolan Kwanza  ),XCD   (  East Carribean Dollar  ),AMD   (  Armenian Dram  ),AWG   (  Aruban Florin  ),SHP   (  St. Helena Pound  ),AUD   (  Australian Dollar  ),AZN   (  Azerbaijan New Manat  ),BSD   (  Bahamian Dollar  ),BHD   (  Bahraini Dinar  ),BDT   (  Bangladeshi Taka  ),BYR   (  Belarusian Ruble  ),BZD   (  Belize Dollar  ),XOF   (  CFA Franc BCEAO  ),BMD   (  Bermudian Dollar  ),BTN   (  Bhutan Ngultrum  ),BAM   (  Bosnian Mark  ),BWP   (  Botswana Pula  ),NOK   (  Norwegian Kroner  ),BRL   (  Brazilian Real  ),BND   (  Brunei Dollar  ),BGN   (  Bulgarian Lev  ),BIF   (  Burundi Franc  ),KHR   (  Cambodian Riel  ),XAF   (  CFA Franc BEAC  ),CAD   (  Canadian Dollar  ),CVE   (  Cape Verde Escudo  ),KYD   (  Cayman Islands Dollar  ),CLP   (  Chilean Peso  ),KMF   (  Comoros Franc  ),CDF   (  Congolese Franc  ),NZD   (  New Zealand Dollar  ),CRC   (  Costa Rican Colon  ),CZK   (  Czech Koruna  ),DKK   (  Danish Krone  ),DJF   (  Djibouti Franc  ),DOP   (  Dominican Peso  ),EGP   (  Egyptian Pound  ),ERN   (  Eritrean Nakfa  ),XPF   (  CFP Franc  ),NIO   (  Nicaraguan Cordoba Oro  ),NGN   (  Nigerian Naira  ),OMR   (  Omani Rial  ),PKR   (  Pakistan Rupee  ),PGK   (  Papua New Guinea Kina  ),PYG   (  Paraguay Guarani  ),PHP   (  Philippine Peso  ),PLN   (  Polish Zloty  ),QAR   (  Qatari Rial  ),RON   (  Romanian New Leu  ),RUB   (  Russian Rouble  ),RWF   (  Rwandan Franc  ),WST   (  Samoan Tala  ),STD   (  Sao Tome/Principe Dobra  ),SAR   (  Saudi Riyal  ),RSD   (  Serbian Dinar  ),SCR   (  Seychelles Rupee  ),SLL   (  Sierra Leone Leone  ),SGD   (  Singapore Dollar  ),SBD   (  Solomon Islands Dollar  ),SOS   (  Somali Shilling  ),ZAR   (  South African Rand  ),KRW   (  Korean Won  ),LKR   (  Sri Lanka Rupee  ),SRD   (  Suriname Dollar  ),SZL   (  Swaziland Lilangeni  ),SEK   (  Swedish Krona  ),CHF   (  Swiss Franc  ),TWD   (  Taiwan Dollar  ),TJS   (  Tajikistan Somoni  ),TZS   (  Tanzanian Shilling  ),THB   (  Thai Baht  ),TOP   (  Tongan Pa'anga  ),TTD   (  Trinidad/Tobago Dollar  ),TND   (  Tunisian Dinar  ),TRY   (  Turkish Lira  ),TMT   (  Turkmenistan New Manat  ),UGX   (  Uganda Shilling  ),UAH   (  Ukraine Hryvnia  ),AED   (  Utd. Arab Emir. Dirham  ),GBP   (  United Kingdom Pound  ),UYU   (  Uruguayan Peso  ),UZS   (  Uzbekistan Som  ),VUV   (  Vanuatu Vatu  ),VEF   (  Venezuelan Bolivar Fuerte  ),VND   (  Vietnamese Dong  ),YER   (  Yemen Rial  ),ZMW   (  Zambian Kwacha  ),ZWL   (  Zimbabwe Dollar  ),ETB   (  Ethiopian Birr  ),FKP   (  Falkland Islands Pound  ),FJD   (  Fiji Dollar  ),GMD   (  Gambian Dalasi  ),GEL   (  Georgian Lari  ),GHS   (  Ghanaian New Cedi  ),GIP   (  Gibraltar Pound  ),GTQ   (  Guatemalan Quetzal  ),GNF   (  Guinea Franc  ),GYD   (  Guyanan Dollar  ),HTG   (  Haitian Gourde  ),HNL   (  Honduran Lempira  ),HKD   (  Hong Kong Dollar  ),HUF   (  Hungarian Forint  ),ISK   (  Iceland Krona  ),INR   (  Indian Rupee  ),IDR   (  Indonesian Rupiah  ),IQD   (  Iraqi Dinar  ),ILS   (  Israeli New Shekel  ),JMD   (  Jamaican Dollar  ),JPY   (  Japanese Yen  ),KZT   (  Kazakhstan Tenge  ),KES   (  Kenyan Shilling  ),KWD   (  Kuwaiti Dinar  ),KGS   (  Kyrgyzstanian Som  ),LAK   (  Lao Kip  ),LBP   (  Lebanese Pound  ),LSL   (  Lesotho Loti  ),LRD   (  Liberian Dollar  ),LYD   (  Libyan Dinar  ),MOP   (  Macanese pataca  ),MKD   (  Macedonian Denar  ),MWK   (  Malawi Kwacha  ),MYR   (  Malaysian Ringgit  ),MVR   (  Maldive Rufiyaa  ),MUR   (  Mauritius Rupee  ),MXN   (  Mexican peso  ),MDL   (  Moldovan Leu  ),MNT   (  Mongolian Tugrik  ),MAD   (  Moroccan Dirham  ),MZN   (  Mozambique New Metical  ),MMK   (  Myanmar Kyat  ),NAD   (  Namibia Dollar  ),NPR   (  Nepalese Rupee  ),ARS   (  Argentine Peso  ),PEN   (  Peruvian Nuevo Sol  ),DZD   (  Algerian Dinar  ),JOD   (  Jordanian Dinar  ),BOB   (  Bolivian Mvdol  ),COP   (  Unidad de Valor Real  ),BBD   (  Barbados Dollar  ),PAB   (  Panamanian balboa  )`
  return currencys.split(',')
}

function options() {
  var options = 'AliExpress Standard Shipping,China Post Registered Air Mail,EMS,ePacket,DHL,FedEx,Singapore Post,TNT,UPS,USPS'
  return options.split(',')
}

// 页面初始化
(() => {
  sliderInit()
})()
// 动态添加 国家、货币 option
countrys().forEach((element, index) => {
  const option = $(`<option value=${index}>${element}</option>`)
  $('#country').append(option)
})
currencys().forEach((element, index) => {
  const option = $(`<option value=${index}>${element}</option>`)
  $('#currency').append(option)
})

function sliderLift(target) {
  target.removeClass('to-right')
  target.addClass('to-left')
  target.parent()[0].style.backgroundColor = '#ccc'
  target.attr('data-check', '')
}

function sliderRight(target) {
  target.removeClass('to-left')
  target.addClass('to-right')
  target.parent()[0].style.backgroundColor = '#67C23A'
  target.attr('data-check', 'check')
}

// data-check 选中状态
function shippingCheck() {
  const shipping_check = $($('.show_shipping')[0].children[0])
  if (shipping_check.attr('data-check')) {
    sliderLift(shipping_check)
    $('.show-shipping-area')[0].style.display = 'none'
  } else {
    $('.show-shipping-area')[0].style.display = 'block'
    sliderRight(shipping_check)
  }
}

function processingCheck() {
  const processing_check = $($('.show_processing')[0].children[0])
  if (processing_check.attr('data-check')) {
    sliderLift(processing_check)
  } else {
    sliderRight(processing_check)
  }
}

function hideItemCheck() {
  const hide_item_check = $($('.hide-item')[0].children[0])
  if (hide_item_check.attr('data-check')) {
    sliderLift(hide_item_check)
  } else {
    sliderRight(hide_item_check)
  }
}

// 保存设置状态
$('#saveSetting').click(function () {
  var obj = {}
  obj['show_shipping_status'] = $($('.show_shipping')[0].children[0]).attr('data-check') ? '1' : '0'
  obj['hide_item_status'] = $($('.hide-item')[0].children[0]).attr('data-check') ? '1' : '0'
  obj['show_processing_status'] = $($('.show_processing')[0].children[0]).attr('data-check') ? '1' : '0'
  obj.country = $('#country').val()
  obj.currency = $('#currency').val()
  obj.option = $('#option').val()
  // 保存数据
  chrome.storage.sync.set({ status: obj })
})

// 显示选项
function showSelect() {
  if (!$($('.show_shipping')[0].children[0]).attr('data-check')) {
    $('.show-shipping-area')[0].style.display = 'none'
  } else {
    $('.show-shipping-area')[0].style.display = 'none'
  }
}

// 初始化缓存数据回填
function defaultSelect() {
  chrome.storage.sync.get({ status }, function (item) {
    if (item.status.show_processing_status === '1') {
      processingCheck()
    }
    if (item.status.show_shipping_status === '1') {
      shippingCheck()
    }
    if (item.status.hide_item_status === '1') {
      hideItemCheck()
    }
    $('#country').val(item.status.country)
    $('#option').val(item.status.option)
    $('#currency').val(item.status.currency)
  })
}

function sliderInit() {
  showSelect()
  var shippingSlider = $('.show_shipping')[0]
  var processingSlider = $('.show_processing')[0]
  var hideSlider = $('.hide-item')[0]
  shippingSlider.addEventListener('click', shippingCheck)
  processingSlider.addEventListener('click', processingCheck())
  hideSlider.addEventListener('click', hideItemCheck)
  Array.from($('.slider')).forEach((v, k) => {
    if ($(v).attr('data-check')) {
      $(v).attr('data-check', '')
      v.click()
    }
  })
  rmEvent(shippingSlider,shippingCheck)
  rmEvent(processingSlider,processingCheck)
  rmEvent(hideSlider,hideItemCheck)
  function rmEvent(dom, fn) {
    if ($(dom).attr('disabled')) {
      dom.style.cursor = 'not-allowed'
      dom.removeEventListener('click', fn)
    }
  }
}